% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/profile_DEG.R
\name{profile_cluster_DEG}
\alias{profile_cluster_DEG}
\title{profile_cluster_DEG}
\usage{
profile_cluster_DEG(
  profile,
  cluster,
  exprs,
  cell_meta,
  cell_profile_prob,
  cluster_col = "cluster",
  pseudotime_col = "cell_t",
  permute_n = 50
)
}
\arguments{
\item{profile}{Character or numeric vector indicating which profiles to test.}

\item{cluster}{Character or factor. Name or ID of the cluster to analyze.}

\item{exprs}{A gene expression matrix (genes × cells).}

\item{cell_meta}{A data frame of cell-level metadata (must include pseudotime and cluster labels).}

\item{cell_profile_prob}{A numeric matrix of profile probabilities (cells × profiles).}

\item{cluster_col}{Name of the column in `cell_meta` for cluster labels (default: `"cluster"`).}

\item{pseudotime_col}{Name of the column in `cell_meta` representing pseudotime (default: `"cell_t"`).}

\item{permute_n}{Integer. Number of permutations for null model generation (default: 50).}
}
\value{
A list containing:\n
\item{stat}{Data frame with statistics, empirical p-values, and FDR-adjusted p-values}\n
\item{cell}{Character vector of cell IDs used in the test}\n
\item{design_null, design_full, coef, df}{Model components from GAM fitting}
}
\description{
Differential Expression Between Profile and Background in a Single Cluster
}
\details{
Performs pseudotime-aware differential expression testing between a target profile and control background
within a specific transcriptional cluster. Combines soft cluster-weighted regression with permutation-derived
null distributions to assess gene-level significance.
}
\examples{
# Assuming cell_meta, exprs, and cell_profile_prob are defined
res <- profile_cluster_DEG("P1", cluster = "C2", exprs, cell_meta, cell_profile_prob)
head(res$stat)

}
