% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/profile_DEG.R
\name{cluster_profile_enrich}
\alias{cluster_profile_enrich}
\title{cluster_profile_enrich}
\usage{
cluster_profile_enrich(cell_profile_prob, cluster_label, permute_n = 300)
}
\arguments{
\item{cell_profile_prob}{A matrix of profile probabilities (cells Ã— profiles).}

\item{cluster_label}{A vector of cluster identities (length = number of rows in `cell_profile_prob`).}

\item{permute_n}{Integer. Number of permutations to perform (default: 300).}
}
\value{
A list with two elements:\n
\item{prob}{Observed profile mass per cluster (same format as `cluster_profile_mass()`)}\n
\item{pval}{Matrix of empirical p-values (1-sided) indicating profile enrichment}
}
\description{
Permutation-Based Enrichment Test of Profiles Within Clusters
}
\details{
Tests whether specific profiles are statistically enriched in transcriptional clusters using permutation testing.
Compares the observed profile mass per cluster to a null distribution generated by random label permutations.
}
\examples{
set.seed(42)
profile_probs <- matrix(runif(200), nrow = 50, ncol = 4)
profile_probs <- profile_probs / rowSums(profile_probs)
clusters <- sample(1:5, 50, replace = TRUE)
result <- cluster_profile_enrich(profile_probs, clusters, permute_n = 100)
head(result$pval)

}
