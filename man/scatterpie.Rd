% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization.R
\name{scatterpie}
\alias{scatterpie}
\title{scatterpie}
\usage{
scatterpie(
  scatter_coord,
  composition,
  connectivity = NULL,
  connectivity_thresh = 0.5,
  dims = c("umap_1", "umap_2"),
  cluster_col = "cluster",
  edge_color = "lightgrey",
  edge_alpha = 1,
  label_size = 5
)
}
\arguments{
\item{scatter_coord}{A data frame of coordinates (e.g., UMAP or spatial centroids), one row per cluster.}

\item{composition}{A numeric matrix or data frame (same number of rows as `scatter_coord`) where each row gives the proportions or counts of categories.}

\item{connectivity}{Optional. A square matrix indicating edge weights (e.g., similarity or shared connectivity) between clusters.}

\item{connectivity_thresh}{Numeric threshold above which edges are shown (default: 0.5).}

\item{dims}{A character vector of length 2 specifying the coordinate column names in `scatter_coord` (default: `c("umap_1", "umap_2")`).}

\item{cluster_col}{Character. The column in `scatter_coord` that contains cluster or group labels for annotation (default: `"cluster"`).}

\item{edge_color}{Color for the connectivity edges (default: `"lightgrey"`).}

\item{edge_alpha}{Alpha transparency for the edges (default: 1).}

\item{label_size}{Numeric size for the cluster label text (default: 5).}
}
\value{
A list of `ggplot2` layers (can be added to a base ggplot using `+`) including:
\describe{
  \item{geom_segment}{(optional) edges between connected clusters}
  \item{geom_scatterpie}{pie chart layer showing cluster composition}
  \item{geom_text_repel}{cluster labels}
  \item{theme_classic}{plot styling}
}
}
\description{
Plot Cluster Compositions as Scatterpie Chart with Connectivity Edges
}
\details{
Creates a `ggplot2` layer list showing pie charts at spatial or embedding coordinates, where each pie represents
the relative composition of categories (e.g., cell types, fates) per cluster or region. Optionally overlays connectivity
edges between clusters based on a provided adjacency matrix.
}
\examples{
\dontrun{
library(scatterpie)
coords <- data.frame(umap_1 = rnorm(5), umap_2 = rnorm(5), cluster = letters[1:5])
comp <- matrix(runif(5 * 3), nrow = 5)
colnames(comp) <- c("A", "B", "C")
comp <- comp / rowSums(comp)
scatterpie(coords, comp)
}

}
