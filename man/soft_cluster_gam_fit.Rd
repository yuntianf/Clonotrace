% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/profile_DEG.R
\name{soft_cluster_gam_fit}
\alias{soft_cluster_gam_fit}
\title{soft_cluster_gam_fit}
\usage{
soft_cluster_gam_fit(G, t, P, df = 5, lambda = 1e-04, test = "F")
}
\arguments{
\item{G}{A matrix of gene expression values (genes × cells).}

\item{t}{A numeric vector of pseudotime values (length = number of cells).}

\item{P}{A soft cluster assignment matrix (cells × clusters), where rows sum to 1.}

\item{df}{Degrees of freedom for spline basis (default: 5).}

\item{lambda}{Ridge regularization strength (default: 1e-4).}

\item{test}{Statistical test to use for model comparison: `"F"` (default) or `"LRT"` (likelihood ratio test).}
}
\value{
A list with components:\n
\item{stat}{A data frame with test statistic, p-value, mean expression difference, and Cohen's d for each gene}\n
\item{df}{Degrees of freedom used for test}\n
\item{coef}{Fitted coefficients from the full model}\n
\item{design_null}{Design matrix for the null model}\n
\item{design_full}{Design matrix for the full model}
}
\description{
Fit Soft Cluster-Specific GAMs with Ridge Regularization
}
\details{
Fits a generalized additive model (GAM) to gene expression along pseudotime using soft cluster assignments.
The model compares a shared smooth (null model) to cluster-specific smooths (full model), using ridge regression and F or likelihood ratio tests.
}
\examples{
# Example pseudotime, profiles, and expression matrix setup
set.seed(123)
t <- seq(0, 1, length.out = 100)
P <- matrix(runif(300), nrow = 100)
P <- P / rowSums(P)
G <- matrix(rnorm(500), nrow = 5)
fit <- soft_cluster_gam_fit(G, t, P, df = 3)
head(fit$stat)

}
